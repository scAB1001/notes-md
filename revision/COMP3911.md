# 01. Intro
## Security Goals & Properties
- Data confidentiality
- Data integrity: No modification, insertion, deletion or replay
- High availability: Amazon systems aer available 99.9% of the year
- Authenticity: Data sources and system users
- Access control
- Trustworthy system logs
## Attackers follow the M.O.M. acronym 
**Method**: They have the skills and tools to attack the systems and potentially have information about it.
**Opportunity**: They have a time/chance and the acces to carry out this attack e.g., systems can be accessed remotely.
**Motive**: They have a reason to attack e.g., Financial or Political.
### Assets and Adversaries 
To identify assets, you must analyse the system and the user themselves e.g., A photo of a celebrity is considered an asset, whereas a photo of a non-famous person might not be. Likewise, user data is considered an asset as it's exposure can lead to financial gain.

An adversary is the perpetrator with their eyes on the asset.
### Vulnerabilities
For attacks to be possible there must be vulnerabilities. These occur when system specifications or conditions are loosely defined e.g., buffer overflows (unspecified buffer size) and SQL Injection attacks.
### Threats
A threat is a set of circumstances that has the *potential* to cause *harm or loss*.
### Problem
A problem exists when there is both a threat and a vulnerability.
If the vulnerability can be controlled the then threat can be contained e.g., a *vulnerability* of unprotected data can be *mitigated* via the enabling of access control.
## Threats and Controls
Four main types of threats:
1. Interception: Gaining access to an asset.
2. Interruption: Preventing access to an asset.
3. Modification: Tampering of an asset.
4. Fabrication: Addition of nonexistent items.

Four main types of controls:
1. Prevention: Remove all vulnerabilities.
2. Deferral: Deal with the vulenrability.
3. Deflection: Change the nature of the asset e.g., data may be moved from on-site to cloud.
4. Detection: Controls to observe the attacks.
5. Recovery: Moving on from attacks.
## Why is security hard
- Humans make mistakes (**PEBKAC**: Problem Exists Between Keyboard and Chair)
- Assumptions are made incorrectly
- It is not easily quantified and there is no scoring system or real measure of secure.
- Emergent system properties are unpredictable.
## Hackers
- Originally defined as someone who enjoys understanding and tinkering with software or hardware.
- Different types:
	- White Hat: Uses skills ethically.
	- Black Hat: Uses skills unethically.
# 01. Threat modelling pt. 1
Threat modelling is the *process* of *identifying* the *possible threats* to a system. 
It allows us to understand the capabilities of attackers and their threats which will endanger the security policies in place. This approach is cost-effective as it avoids mistakes/future threats that are alike.
##### Bellovin’s Threat Matrix → ![[bellovin-threat-matrix.png]]
#### Advanced Persistent Threats
- Highly skilled attackers
- Targeted and prolonged cyber-attack campaigns
- Complex, multidimensional attacks, often tightly focused and very difficult to deflect (e.g., **Stuxnet**)
- ‘Cyber-warfare’ involving ‘state actors’ (e.g., national intelligence agencies)
### Security Engineering
The design process for security follows threat modelling, security requirement building and security mechanism development.
The thread model allows security designers to estimate the stregnth of the attacker.
## Main steps for threat Modelling
### 1. System Characterisation 
Characterise the system into main modules to see the system's data flow.
To understand the system components and their interconnections, define:
- Usage scenarios
- Assumptions
- Dependencies

and model:
- Data flow diagrams
- The Network
- State machines
- At varying granularity e.g. APIs, classes or methods.
### 2. Asset and Access Point Identification 
Identify assets and access points to understand how a user would access the system.
- What are we trying to protect?
- How can we reach the system and asset?
### 3. Threat Identification 
Identify any threats. Threats to different components will differ.
Assets can be reached via access points through components and their interaconnections.
Develop a threat profile for each threat (classified as high or low risk).
#### Threat Enumeration
Threats can come from both outside and in.
For each asset, attack goals need to be made for the asset.
The adversary type can be discovered by correlating threats to assets.
#### Attack Trees
A conceptual tree structure used to show how an asset can be attacked (the root node).
Each node represents a condition/predicate/action. E.g., Pick lock (*Impossible*), Learn combination (*Possible*)->Get from staff->Blackmail, Learn combination (*P*)->Get from staff->Bribe.
## The STRIDE Threat Model Classification
Acting as a useful checklist of threats and their effects. It also assigns priority to threats
Six impact-based threat classifications:
### 1. Spoofing - masquerade e.g., unauthorised access.
E.g., email spoofing: fake sender address appears to come from a trusted source.
Website spoofing: fraudulent site masquerades as legitimate to steal credentials.
### 2. Tampering - violates data integrity.
E.g., Hacker disabling anti-virus on a machine.
**Man in the Middle Attack**: intercepts/alters communication between two parties.
### 3. Repudiation - Deny performing action.
E.g., user denies making an online transaction and the system lacks sufficient evidence, like a digital signature, to prove otherwise. This is the reason log files exist. Common in E-commerce.
### 4. Info disclosure - violate confidentiality.
E.g., Servers revealing directory structures, detailed messages exposing software/protocol versions.
### 5. Denial of Service
E.g., Mirai botnet: Consisted of large number of IoT devices such as IP cameras.
Instructed to send a large number of traffic to Dyn (DNS provider) servers. Prevent the system from providing the designated service.
### 6. Elevation of privilege - Gaining special status.
E.g., Flaw in OS (buffer overflow). Ultimately, get admin privileges.

We think of threats and attack in the terms of these classifications as well as terms of breaches of confidentiality, integrity or availability.
E.g., Data in transit from A to B, can be *tampered* with, violating *integrity*. 
To mitigate this, can we use a Secure Hashing Algorithm?
### STRIDE Per Element
Certain threats are more prevalent than others and should be focused.
## Specifying Security Requirements
These threats are translated into requirements and prioritsed (cannot handle all of them).
E.g., 
	**THREAT**: DoS attack on system
	**HOW**: Flood Network Interface or Disk Space
	**RISK**: High
	**REQUIREMENT**: DoS should not be allowed.
	**MECHANISMS**: Use firewall to drop certain packets and restrict resources used by anonymous users.
# 02. Threat modelling pt. 2
## STRIDE Model Goals
Threat modelling can be considered from three different perspectives:
### 1. Assets
The valuables.
Tangible things which obvious for attackers e.g., user credentials, bank details.
Intangible things which need to be protected e.g., reputation, system availability.
### 2. Attackers
Consider human threat agents. Lacks structural detail to help identify an attacker's methodology.
Prrone to bias when creating an potential attacker list.
### 3. Software
Using scenario-based/user story problems to explore potential problems.
Can be highly structured by creating and using systems diagrams, making STRIDE calssifications and attack trees.
Software-focused approach is considered to be the best.
## Trust Boundaries
- These emerge when entities, with different levels of access, interact.
- TBs are drawn around user accounts, physical computers, VMs, Network segments, etc.
- They can be identified by:
	- Identify the *principals* (users)
	- Following the privelege spectrum of access e.g., User vs. Admin.
	- A new TB is added every time a principal talks to another
### Entry & Exit Points
- Places where control or data *cross* a *trust boundary*.
- Easy to overlook infrastructure entry points e.g., Config files, Windows registry, etc.
- Entry points can be layered.
### Importance
TBs delineate the attack surface between principals. 
Threats tend to cluster around the entry/exit points on TBs and can follow data flows.
So, diagramming mainly helps us to learn, in a systematic way, **where** we should look for threats.