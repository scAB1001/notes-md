Wednesday 08/10/2025

---
### Objectives
- For you to appreciate the importance of threat modelling in secure software development
- For you to understand the value of data flow diagrams and STRIDE to explore threats
- For you to see how attack trees can be used for risk assessment and threat mitigation

Threat Modelling Goals
- Understand system’s threat profile
- Facilitate secure design and implementation
	- Identify and justify need for security features
	- Prescribe implementation practices
- Guide code reviews and penetration tests
- Discover vulnerabilities

Trust Boundaries
- These will occur at any point where entities with different levels of privilege interact
- TBs can typically be drawn around different user accounts, physical computers, VMs, network segments, etc
- To find them:
	- Identify the different principals
	- Start from either end of the ‘privilege spectrum’ (e.g., Internet user or system administrator)
	- Add a new TB each time a principal ‘talks to’ another

Entry & Exit Points
- Places where control or data crosses a trust boundary
- Easy to overlook infrastructure entry points!
	- Config files, Windows registry, etc
- Entry points can be layered

https://www.foo.com/login.jsp?cmd=NewUser
Port 443 of www.foo.com, Login page, NewUser operation

Why Is All This Useful?
TBs delineate the attack surface between principals
Threats tend to cluster around the entry/exit points on TBs  and can follow data flows
So diagramming mainly helps us to learn, in a systematic way, where we should look for threats

Labelling Threats: STRIDE (114-121)
- Spoofing identity
- Tampering with data
- Repudiation
- Information disclosure
- Denial of service
- Elevation of privilege

Benefits of STRIDE
- Acts as a useful ‘checklist’ when considering what might threaten an element of a DFD
- Makes it easier to understand threat effects
- Helps to assign a priority to threats
	- EoP often the most serious
	- Repudiation may be critical in financial sector

Simpler Models
IIMF -- Interception, Interruption, Modification, Fabrication
CIA -- Confidentiality, Integrity, Availability

Attack Trees
- Root node, representing a threat
- Child nodes, each representing a condition that must be true for attack to succeed
- Arcs between parent and child nodes
- Path from a leaf node to root is an attack path
	- Dashed line can be used to indicate low likelihood
- Boolean relationships between siblings
	- OR is implicit
	- AND must be shown explicitly
![[attack-tree-ex.png]]
Textual Representation
1 Threat
1.1 (AND) Unmitigated condition
1.2 (AND) Unmitigated condition
1.2.1 Mitigated condition
- Mitigation information
1.2.2 Mitigated condition
1.3 Unmitigated condition
1.3.1 Mitigated condition
1.3.2 Unmitigated condition
Easier to create, but harder to use
Can be made machine-readable – e.g., using XML or
JSON

Risk Assessment: DREAD
For each threat, estimate
Damage potential
Reproducibility (how often an attempt at exploiting a
vulnerability actually works)
Exploitability (effort required to exploit vulnerability)
Affected users (proportion of install base that would be
affected if an exploit became widely available)
Discoverability (likelihood that a vulnerability will be found
by external security researchers or black hats)
(Use a 1–3 or 1–5 scale for each, compute R as a simple
average)

Issues With DREAD
● Values are highly subjective
● Not all dimensions are useful – e.g., why assume that
Discoverability is anything other than 100%?
● Dimensions are weighted equally

CVSS
● Open standard: v2 and v3 in current use
● Scoring is more thorough and objective that DREAD
○ Uses a 0.0 – 10.0 scale
○ Provides a base score for severity, optionally
modified to reflect risks in a specific environment
● Guided online calculators exist
○ https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator
○ https://www.first.org/cvss/calculator/3.0

Mitigation
● Ideally, every threat is mitigated either by design or
implementation of the system
○ Corollary: every security feature should address at
least one threat from the threat model!
● Rank unmitigated threats by risk, and focus on
mitigating the high-risk threats first
![[attack-tree-paths-ex.png]]
![[attack-tree-paths-sol.png]]